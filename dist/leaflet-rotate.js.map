{"version":3,"file":"leaflet-rotate.js","sources":["../src/dom/DomUtil.js","../src/dom/Draggable.js","../src/geometry/Point.js","../src/layer/DivOverlay.js","../src/layer/Popup.js","../src/layer/Tooltip.js","../src/layer/marker/Icon.js","../src/layer/marker/Marker.js","../src/layer/tile/GridLayer.js","../src/layer/vector/Canvas.js","../src/layer/vector/Renderer.js","../src/layer/vector/SVG.js","../src/map/Map.js","../src/map/handler/CompassBearing.js","../src/map/handler/ContainerMutation.js","../src/map/handler/TouchGestures.js","../src/map/handler/TouchRotate.js","../src/map/handler/ShiftKeyRotate.js","../src/map/handler/TouchZoom.js","../src/control/Rotate.js"],"sourcesContent":["/**\n * L.DomUtil\n */\nconst domUtilProto = {\n    setTransform: L.DomUtil.setTransform,\n    setPosition: L.DomUtil.setPosition\n};\n\nL.extend(L.DomUtil, {\n\n    setTransform: function(el, offset, scale, bearing, pivot) {\n        var pos = offset || new L.Point(0, 0);\n\n        if (!bearing) {\n            offset = pos._round();\n            return domUtilProto.setTransform.call(this, el, offset, scale);\n        }\n\n        pos = pos.rotateFrom(bearing, pivot);\n\n        el.style[L.DomUtil.TRANSFORM] =\n            'translate3d(' + pos.x + 'px,' + pos.y + 'px' + ',0)' +\n            (scale ? ' scale(' + scale + ')' : '') +\n            ' rotate(' + bearing + 'rad)';\n    },\n\n    setPosition: function(el, point, bearing, pivot) { // (HTMLElement, Point[, Boolean])\n        if (!bearing) {\n            return domUtilProto.setPosition.call(this, el, point);\n        }\n\n        /*eslint-disable */\n        el._leaflet_pos = point;\n        /*eslint-enable */\n\n        if (L.Browser.any3d) {\n            L.DomUtil.setTransform(el, point, undefined, bearing, pivot);\n        } else {\n            el.style.left = point.x + 'px';\n            el.style.top = point.y + 'px';\n        }\n    },\n\n    // Constants for rotation\n    DEG_TO_RAD: Math.PI / 180,\n    RAD_TO_DEG: 180 / Math.PI,\n\n});\r\n","/**\n * L.Draggable\n */\nL.Draggable.include({\n\n    updateMapBearing: function(mapBearing) {\n        this._mapBearing = mapBearing;\n    },\n\n});\r\n","/**\n * L.Point\n */\nL.extend(L.Point.prototype, {\n\n    // Rotate around (0,0) by applying the 2D rotation matrix:\n    // ⎡ x' ⎤ = ⎡ cos θ  -sin θ ⎤ ⎡ x ⎤\n    // ⎣ y' ⎦   ⎣ sin θ   cos θ ⎦ ⎣ y ⎦\n    // Theta must be given in radians.\n    rotate: function(theta) {\n        if (!theta) { return this; }\n        var sinTheta = Math.sin(theta);\n        var cosTheta = Math.cos(theta);\n\n        return new L.Point(\n            this.x * cosTheta - this.y * sinTheta,\n            this.x * sinTheta + this.y * cosTheta\n        );\n    },\n\n    // Rotate around (pivot.x, pivot.y) by:\n    // 1. subtract (pivot.x, pivot.y)\n    // 2. rotate around (0, 0)\n    // 3. add (pivot.x, pivot.y) back\n    // same as `this.subtract(pivot).rotate(theta).add(pivot)`\n    rotateFrom: function(theta, pivot) {\n        if (!theta) { return this; }\n        var sinTheta = Math.sin(theta);\n        var cosTheta = Math.cos(theta);\n        var cx = pivot.x,\n            cy = pivot.y;\n        var x = this.x - cx,\n            y = this.y - cy;\n\n        return new L.Point(\n            x * cosTheta - y * sinTheta + cx,\n            x * sinTheta + y * cosTheta + cy\n        );\n    },\n\n});\r\n","/**\n * L.DivOverlay\n */\nconst divOverlayProto = {\n    getEvents: L.DivOverlay.prototype.getEvents,\n    _updatePosition: L.DivOverlay.prototype._updatePosition,\n};\n\nL.DivOverlay.include({\n\n    getEvents: function() {\n        return L.extend(divOverlayProto.getEvents.call(this), { rotate: this._updatePosition });\n    },\n\n    _updatePosition: function() {\n        if (!this._map) { return; }\n\n        var pos = this._map.latLngToLayerPoint(this._latlng),\n            offset = L.point(this.options.offset),\n            anchor = this._getAnchor();\n\n        if (this._zoomAnimated) {\n            // TODO: use divOverlayProto._updatePosition\n            if (this._map._rotate) {\n                pos = this._map.rotatedPointToMapPanePoint(pos);\n            }\n            L.DomUtil.setPosition(this._container, pos.add(anchor));\n        } else {\n            offset = offset.add(pos).add(anchor);\n        }\n\n        var bottom = this._containerBottom = -offset.y,\n            left = this._containerLeft = -Math.round(this._containerWidth / 2) + offset.x;\n\n        // bottom position the popup in case the height of the popup changes (images loading etc)\n        this._container.style.bottom = bottom + 'px';\n        this._container.style.left = left + 'px';\n    },\n\n});\r\n","/**\n * L.Popup\n */\nconst popupProto = {\n    _animateZoom: L.Popup.prototype._animateZoom,\n    _adjustPan: L.Popup.prototype._adjustPan,\n};\n\nL.Popup.include({\n\n    _animateZoom: function(e) {\n        if (!this._map._rotate) {\n            popupProto._animateZoom.call(this, e);\n        }\n        var pos = this._map._latLngToNewLayerPoint(this._latlng, e.zoom, e.center),\n            anchor = this._getAnchor();\n\n        pos = this._map.rotatedPointToMapPanePoint(pos);\n\n        L.DomUtil.setPosition(this._container, pos.add(anchor));\n    },\n\n    _adjustPan: function() {\n        if (!this.options.autoPan || (this._map._panAnim && this._map._panAnim._inProgress)) { return; }\n\n        var map = this._map,\n            marginBottom = parseInt(L.DomUtil.getStyle(this._container, 'marginBottom'), 10) || 0,\n            containerHeight = this._container.offsetHeight + marginBottom,\n            containerWidth = this._containerWidth,\n            layerPos = new L.Point(this._containerLeft, -containerHeight - this._containerBottom);\n\n        layerPos._add(L.DomUtil.getPosition(this._container));\n\n        // var containerPos = map.layerPointToContainerPoint(layerPos);\n        // TODO: use popupProto._adjustPan\n        var containerPos = layerPos._add(this._map._getMapPanePos()),\n            padding = L.point(this.options.autoPanPadding),\n            paddingTL = L.point(this.options.autoPanPaddingTopLeft || padding),\n            paddingBR = L.point(this.options.autoPanPaddingBottomRight || padding),\n            size = map.getSize(),\n            dx = 0,\n            dy = 0;\n\n        if (containerPos.x + containerWidth + paddingBR.x > size.x) { // right\n            dx = containerPos.x + containerWidth - size.x + paddingBR.x;\n        }\n        if (containerPos.x - dx - paddingTL.x < 0) { // left\n            dx = containerPos.x - paddingTL.x;\n        }\n        if (containerPos.y + containerHeight + paddingBR.y > size.y) { // bottom\n            dy = containerPos.y + containerHeight - size.y + paddingBR.y;\n        }\n        if (containerPos.y - dy - paddingTL.y < 0) { // top\n            dy = containerPos.y - paddingTL.y;\n        }\n\n        // @namespace Map\n        // @section Popup events\n        // @event autopanstart: Event\n        // Fired when the map starts autopanning when opening a popup.\n        if (dx || dy) {\n            map\n                .fire('autopanstart')\n                .panBy([dx, dy]);\n        }\n    },\n\n});\r\n","/**\n * L.Tooltip\n */\nconst tooltipProto = {\n    _updatePosition: L.Tooltip.prototype._updatePosition,\n    _animateZoom: L.Tooltip.prototype._animateZoom,\n};\n\nL.Tooltip.include({\n\n    _updatePosition: function() {\n        if (!this._map._rotate) {\n            return tooltipProto._updatePosition.call(this);\n        }\n        var pos = this._map.latLngToLayerPoint(this._latlng);\n\n        pos = this._map.rotatedPointToMapPanePoint(pos);\n        this._setPosition(pos);\n    },\n\n    _animateZoom: function(e) {\n        if (!this._map._rotate) {\n            return tooltipProto._animateZoom.call(this);\n        }\n        var pos = this._map._latLngToNewLayerPoint(this._latlng, e.zoom, e.center);\n\n        pos = this._map.rotatedPointToMapPanePoint(pos);\n        this._setPosition(pos);\n    },\n\n});\r\n","/**\n * L.Icon\n */\nconst iconProto = {\n    _updatePosition: L.Icon.prototype._setIconStyles,\n};\n\nL.Icon.include({\n\n    _setIconStyles: function(img, name) {\n        var options = this.options;\n        var sizeOption = options[name + 'Size'];\n\n        if (typeof sizeOption === 'number') {\n            sizeOption = [sizeOption, sizeOption];\n        }\n\n        var size = L.point(sizeOption),\n            anchor = L.point(name === 'shadow' && options.shadowAnchor || options.iconAnchor ||\n                size && size.divideBy(2, true));\n\n        img.className = 'leaflet-marker-' + name + ' ' + (options.className || '');\n\n        if (anchor) {\n            img.style.marginLeft = (-anchor.x) + 'px';\n            img.style.marginTop = (-anchor.y) + 'px';\n            // TODO: use iconProto._setIconStyles\n            img.style[L.DomUtil.TRANSFORM + \"Origin\"] = anchor.x + \"px \" + anchor.y + \"px 0px\";\n        }\n\n        if (size) {\n            img.style.width = size.x + 'px';\n            img.style.height = size.y + 'px';\n        }\n    },\n\n});\r\n","/**\n * L.Handler.MarkerDrag\n */\nvar markerDragProto = {\n    _onDragStart: function() {},\n    _onDrag: function() {},\n    _onDragEnd: function() {},\n};\n\nvar MarkerDrag = {\n\n    _onDragStart: function() {\n        if (!this._marker._map._rotate) {\n            return markerDragProto._onDragStart.call(this)\n        }\n        this._draggable.updateMapBearing(this._marker._map._bearing);\n    },\n\n    _onDrag: function(e) {\n        var marker = this._marker,\n            // TODO: use markerDragProto._onDrag\n            rotated_marker = marker.options.rotation || marker.options.rotateWithView,\n            shadow = marker._shadow,\n            iconPos = L.DomUtil.getPosition(marker._icon);\n\n        // TODO: use markerDragProto._onDrag\n        // update shadow position\n        if (!rotated_marker && shadow) {\n            L.DomUtil.setPosition(shadow, iconPos);\n        }\n\n        // TODO: use markerDragProto._onDrag\n        if (marker._map._rotate) {\n            // Reverse calculation from mapPane coordinates to rotatePane coordinates\n            iconPos = marker._map.mapPanePointToRotatedPoint(iconPos);\n        }\n        latlng = marker._map.layerPointToLatLng(iconPos);\n\n        marker._latlng = latlng;\n        e.latlng = latlng;\n        e.oldLatLng = this._oldLatLng;\n\n        // TODO: use markerDragProto._onDrag\n        if (rotated_marker) marker.setLatLng(latlng); // use `setLatLng` to presisit rotation. low efficiency\n        else marker.fire('move', e); // `setLatLng` will trig 'move' event. we imitate here.\n\n        // @event drag: Event\n        // Fired repeatedly while the user drags the marker.\n        marker\n            .fire('drag', e);\n    },\n\n    _onDragEnd: function(e) {\n        if (this._marker._map._rotate) {\n            this._marker.update();\n        }\n        markerDragProto.update.call(this, e);\n    },\n\n};\n\n/**\n * L.Marker\n */\nconst markerProto = {\n    getEvents: L.Marker.prototype.getEvents,\n    onAdd: L.Marker.prototype.onAdd,\n    _initInteraction: L.Marker.prototype._initInteraction,\n    _setPos: L.Marker.prototype._setPos,\n    _updateZIndex: L.Marker.prototype._updateZIndex,\n};\n\nL.Marker.mergeOptions({\n\n    // @option rotation: Number = 0\n    // Rotation of this marker in rad\n    rotation: 0,\n\n    // @option rotateWithView: Boolean = false\n    // Rotate this marker when map rotates\n    rotateWithView: false,\n\n});\nL.Marker.include({\n\n    getEvents: function() {\n        return L.extend(markerProto.getEvents.call(this), { rotate: this.update });\n    },\n\n    onAdd: function(map) {\n        markerProto.onAdd.call(this, map);\n        map.on('rotate', this.update, this);\n    },\n\n    _initInteraction: function() {\n        var ret = markerProto._initInteraction.call(this);\n        if (this.dragging && this._map && this._map._rotate) {\n            // L.Handler.MarkerDrag is used internally by L.Marker to make the markers draggable\n            markerDragProto._onDragStart = this.dragging._onDragStart.bind(this.dragging);\n            markerDragProto._onDrag = this.dragging._onDrag.bind(this.dragging);\n            markerDragProto._onDragEnd = this.dragging._onDragEnd.bind(this.dragging);\n            this.dragging._onDragStart = MarkerDrag._onDragStart.bind(this.dragging);\n            this.dragging._onDrag = MarkerDrag._onDrag.bind(this.dragging);\n            this.dragging._onDragEnd = MarkerDrag._onDragEnd.bind(this.dragging);\n        }\n        return ret;\n    },\n\n    _setPos: function(pos) {\n\n        // TODO: use markerProto._setPos\n        if (this._map._rotate) {\n            pos = this._map.rotatedPointToMapPanePoint(pos);\n        }\n\n        // TODO: use markerProto._setPos\n        var bearing = this.options.rotation || 0;\n        if (this.options.rotateWithView) {\n            bearing += this._map._bearing;\n        }\n\n        // TODO: use markerProto._setPos\n        L.DomUtil.setPosition(this._icon, pos, bearing, pos);\n\n        // TODO: use markerProto._setPos\n        if (this._shadow) {\n            L.DomUtil.setPosition(this._shadow, pos, bearing, pos);\n        }\n\n        this._zIndex = pos.y + this.options.zIndexOffset;\n\n        this._resetZIndex();\n    },\n\n    _updateZIndex: function(offset) {\n        if (!this._map._rotate) {\n            return markerProto._updateZIndex.call(this, offset)\n        }\n        this._icon.style.zIndex = Math.round(this._zIndex + offset);\n    },\n\n    setRotation: function(rotation) {\n        this.options.rotation = rotation;\n        this.update();\n    },\n\n});\r\n","/**\n * L.GridLayer\n */\nconst gridLayerProto = {\n    getEvents: L.GridLayer.prototype.getEvents,\n    _getTiledPixelBounds: L.GridLayer.prototype._getTiledPixelBounds,\n};\n\nL.GridLayer.include({\n\n    getEvents: function() {\n        var events = gridLayerProto.getEvents.call(this);\n        if (this._map._rotate && !this.options.updateWhenIdle) {\n            if (!this._onRotate) {\n                this._onRotate = L.Util.throttle(this._onMoveEnd, this.options.updateInterval, this);\n            }\n            events.rotate = this._onRotate;\n        }\n        return events;\n    },\n\n    _getTiledPixelBounds: function(center) {\n        if (!this._map._rotate) {\n            return gridLayerProto._getTiledPixelBounds.call(this, center);\n        }\n\n        var map = this._map,\n            mapZoom = map._animatingZoom ? Math.max(map._animateToZoom, map.getZoom()) : map.getZoom(),\n            scale = map.getZoomScale(mapZoom, this._tileZoom),\n            pixelCenter = map.project(center, this._tileZoom).floor(),\n            size = map.getSize(),\n            halfSize = new L.Bounds([\n                map.containerPointToLayerPoint([0, 0]).floor(),\n                map.containerPointToLayerPoint([size.x, 0]).floor(),\n                map.containerPointToLayerPoint([0, size.y]).floor(),\n                map.containerPointToLayerPoint([size.x, size.y]).floor()\n            ]).getSize().divideBy(scale * 2);\n\n        return new L.Bounds(pixelCenter.subtract(halfSize), pixelCenter.add(halfSize));\n    },\n\n});\r\n","/**\n * L.Canvas\n */\nconst canvasProto = {\n    onAdd: L.Canvas.prototype.onAdd,\n    onRemove: L.Canvas.prototype.onRemove,\n    _update: L.Canvas.prototype._update,\n};\n\nL.Canvas.include({\n\n    onAdd: function() {\n        canvasProto.onAdd.call(this);\n        // When rotating the canvas itself, it is cleared by some weird reason, so redraw.\n        this._map.on('rotate', this._redraw, this);\n    },\n\n    onRemove: function() {\n        canvasProto.onRemove.call(this);\n        this._map.off('rotate', this._redraw, this);\n    },\n\n    _update: function() {\n        canvasProto._update.call(this);\n        // Tell paths to redraw themselves\n        this.fire('update')\n    },\n\n});\r\n","/**\n * L.Renderer\n */\nconst rendererProto = {\n    onAdd: L.Renderer.prototype.onAdd,\n    onRemove: L.Renderer.prototype.onRemove,\n    _updateTransform: L.Renderer.prototype._updateTransform,\n    _update: L.Renderer.prototype._update,\n};\n\nL.Renderer.include({\n\n    onAdd: function() {\n        rendererProto.onAdd.call(this);\n        // this._map.on('rotate', this._update, this);\n    },\n\n    onRemove: function() {\n        rendererProto.onRemove.call(this);\n        // this._map.off('rotate', this._update, this);\n    },\n\n    _updateTransform: function(center, zoom) {\n        if (!this._map._rotate) {\n            return rendererProto._updateTransform.call(this, center, zoom);\n        }\n        var scale = this._map.getZoomScale(zoom, this._zoom),\n            offset = this._map._latLngToNewLayerPoint(this._topLeft, zoom, center);\n        if (L.Browser.any3d) {\n            L.DomUtil.setTransform(this._container, offset, scale);\n        } else {\n            L.DomUtil.setPosition(this._container, offset);\n        }\n    },\n\n    _update: function() {\n        if (!this._map._rotate) {\n            return rendererProto._update.call(this);\n        }\n        // Update pixel bounds of renderer container (for positioning/sizing/clipping later)\n        // Subclasses are responsible of firing the 'update' event.\n        var p = this.options.padding,\n            map = this._map,\n            size = this._map.getSize(),\n            padMin = size.multiplyBy(-p),\n            padMax = size.multiplyBy(1 + p),\n            //// TODO: Somehow refactor this out into map.something() - the code is\n            ////   pretty much the same as in GridLayer.\n            clip = new L.Bounds([\n                map.containerPointToLayerPoint([padMin.x, padMin.y]).floor(),\n                map.containerPointToLayerPoint([padMin.x, padMax.y]).floor(),\n                map.containerPointToLayerPoint([padMax.x, padMin.y]).floor(),\n                map.containerPointToLayerPoint([padMax.x, padMax.y]).floor()\n            ]);\n        //min = this._map.containerPointToLayerPoint(size.multiplyBy(-p)).round();\n\n        this._bounds = clip;\n        // this._topLeft = clip.min;\n        this._topLeft = this._map.layerPointToLatLng(clip.min);\n\n        this._center = this._map.getCenter();\n        this._zoom = this._map.getZoom();\n    },\n\n});\r\n","/**\n * L.SVG\n */\nconst svgProto = {\n    _update: L.SVG.prototype._update,\n};\n\nL.SVG.include({\n\n    _update: function() {\n        svgProto._update.call(this);\n        if (this._map._rotate) {\n            this.fire('update');\n        }\n    },\n\n});\r\n","/**\n * L.Map\n */\nconst mapProto = {\n    initialize: L.Map.prototype.initialize,\n    createPane: L.Map.prototype.createPane,\n    containerPointToLayerPoint: L.Map.prototype.containerPointToLayerPoint,\n    getBounds: L.Map.prototype.getBounds,\n    layerPointToContainerPoint: L.Map.prototype.layerPointToContainerPoint,\n    _initPanes: L.Map.prototype._initPanes,\n    _getCenterOffset: L.Map.prototype._getCenterOffset,\n    _getNewPixelOrigin: L.Map.prototype._getNewPixelOrigin,\n    _handleGeolocationResponse: L.Map.prototype._handleGeolocationResponse,\n};\n\nL.Map.mergeOptions({ rotate: false, });\n\nL.Map.include({\n\n    initialize: function(id, options) { // (HTMLElement or String, Object)\n        if (options.rotate) {\n            this._rotate = true;\n            this._bearing = 0;\n        }\n        mapProto.initialize.call(this, id, options);\n    },\n\n    createPane: function(name, container) {\n        if (!this._rotate || name == 'mapPane') {\n            return mapProto.createPane.call(this, name, container);\n        }\n        // init \"rotatePane\"\n        if (!this._rotatePane) {\n            // this._pivot = this.getSize().divideBy(2);\n            this._rotatePane = mapProto.createPane.call(this, 'rotatePane', this._mapPane);\n            L.DomUtil.setPosition(this._rotatePane, new L.Point(0, 0), this._bearing, this._pivot);\n        }\n        return mapProto.createPane.call(this, name, container || this._rotatePane);\n    },\n\n    containerPointToLayerPoint: function(point) { // (Point)\n        if (!this._rotate) {\n            return mapProto.containerPointToLayerPoint.call(this, point);\n        }\n        return L.point(point)\n            .subtract(this._getMapPanePos())\n            .rotateFrom(-this._bearing, this._getRotatePanePos())\n            .subtract(this._getRotatePanePos());\n    },\n\n    getBounds: function() {\n        if (!this._rotate) {\n            return mapProto.getBounds.call(this);\n        }\n        var size = this.getSize();\n        var topleft = this.layerPointToLatLng(this.containerPointToLayerPoint([0, 0])),\n            topright = this.layerPointToLatLng(this.containerPointToLayerPoint([size.x, 0])),\n            bottomright = this.layerPointToLatLng(this.containerPointToLayerPoint([size.x, size.y])),\n            bottomleft = this.layerPointToLatLng(this.containerPointToLayerPoint([0, size.y]));\n\n        // Use LatLngBounds' build-in constructor that automatically extends the bounds to fit the passed points\n        return new L.LatLngBounds([topleft, topright, bottomright, bottomleft]);\n    },\n\n    layerPointToContainerPoint: function(point) { // (Point)\n        if (!this._rotate) {\n            return mapProto.layerPointToContainerPoint.call(this, point);\n        }\n        return L.point(point)\n            .add(this._getRotatePanePos())\n            .rotateFrom(this._bearing, this._getRotatePanePos())\n            .add(this._getMapPanePos());\n    },\n\n    // Rotation methods\n    // setBearing will work with just the 'theta' parameter.\n    setBearing: function(theta) {\n        if (!L.Browser.any3d || !this._rotate) { return; }\n\n        var rotatePanePos = this._getRotatePanePos();\n        var halfSize = this.getSize().divideBy(2);\n        this._pivot = this._getMapPanePos().clone().multiplyBy(-1).add(halfSize);\n\n        rotatePanePos = rotatePanePos.rotateFrom(-this._bearing, this._pivot);\n\n        this._bearing = theta * L.DomUtil.DEG_TO_RAD; // TODO: mod 360\n        this._rotatePanePos = rotatePanePos.rotateFrom(this._bearing, this._pivot);\n\n        L.DomUtil.setPosition(this._rotatePane, rotatePanePos, this._bearing, this._pivot);\n\n        this.fire('rotate');\n    },\n\n    getBearing: function() {\n        return this._bearing * L.DomUtil.RAD_TO_DEG;\n    },\n\n    _initPanes: function() {\n        var panes = this._panes = {};\n        this._paneRenderers = {};\n\n        // @section\n        //\n        // Panes are DOM elements used to control the ordering of layers on the map. You\n        // can access panes with [`map.getPane`](#map-getpane) or\n        // [`map.getPanes`](#map-getpanes) methods. New panes can be created with the\n        // [`map.createPane`](#map-createpane) method.\n        //\n        // Every map has the following default panes that differ only in zIndex.\n        //\n        // @pane mapPane: HTMLElement = 'auto'\n        // Pane that contains all other map panes\n\n        this._mapPane = this.createPane('mapPane', this._container);\n        L.DomUtil.setPosition(this._mapPane, new L.Point(0, 0));\n\n        if (this._rotate) {\n            this._rotatePane = this.createPane('rotatePane', this._mapPane);\n            this._norotatePane = this.createPane('norotatePane', this._mapPane);\n\n            // @pane tilePane: HTMLElement = 2\n            // Pane for tile layers\n            this.createPane('tilePane', this._rotatePane);\n            // @pane overlayPane: HTMLElement = 4\n            // Pane for overlays like polylines and polygons\n            this.createPane('overlayPane', this._rotatePane);\n\n            // @pane shadowPane: HTMLElement = 5\n            // Pane for overlay shadows (e.g. marker shadows)\n            this.createPane('shadowPane', this._norotatePane);\n            // @pane markerPane: HTMLElement = 6\n            // Pane for marker icons\n            this.createPane('markerPane', this._norotatePane);\n            // @pane tooltipPane: HTMLElement = 650\n            // Pane for tooltips.\n            this.createPane('tooltipPane', this._norotatePane);\n            // @pane popupPane: HTMLElement = 700\n            // Pane for popups.\n            this.createPane('popupPane', this._norotatePane);\n        } else {\n            // @pane tilePane: HTMLElement = 2\n            // Pane for tile layers\n            this.createPane('tilePane');\n            // @pane overlayPane: HTMLElement = 4\n            // Pane for overlays like polylines and polygons\n            this.createPane('overlayPane');\n            // @pane shadowPane: HTMLElement = 5\n            // Pane for overlay shadows (e.g. marker shadows)\n            this.createPane('shadowPane');\n            // @pane markerPane: HTMLElement = 6\n            // Pane for marker icons\n            this.createPane('markerPane');\n            // @pane tooltipPane: HTMLElement = 650\n            // Pane for tooltips.\n            this.createPane('tooltipPane');\n            // @pane popupPane: HTMLElement = 700\n            // Pane for popups.\n            this.createPane('popupPane');\n        }\n\n        if (!this.options.markerZoomAnimation) {\n            L.DomUtil.addClass(panes.markerPane, 'leaflet-zoom-hide');\n            L.DomUtil.addClass(panes.shadowPane, 'leaflet-zoom-hide');\n        }\n    },\n\n    // @method rotatedPointToMapPanePoint(point: Point): Point\n    // Converts a coordinate from the rotated pane reference system\n    // to the reference system of the not rotated map pane.\n    rotatedPointToMapPanePoint: function(point) {\n        return L.point(point).rotate(this._bearing)._add(this._getRotatePanePos());\n    },\n\n    // @method mapPanePointToRotatedPoint(point: Point): Point\n    // Converts a coordinate from the not rotated map pane reference system\n    // to the reference system of the rotated pane.\n    mapPanePointToRotatedPoint: function(point) {\n        return L.point(point)._subtract(this._getRotatePanePos()).rotate(-this._bearing);\n    },\n\n    // offset of the specified place to the current center in pixels\n    _getCenterOffset: function(latlng) {\n        var centerOffset = mapProto._getCenterOffset.call(this, latlng);\n        if (this._rotate) {\n            centerOffset = centerOffset.rotate(this._bearing);\n        }\n        return centerOffset;\n    },\n\n    _getRotatePanePos: function() {\n        return this._rotatePanePos || new L.Point(0, 0);\n    },\n\n    _getNewPixelOrigin: function(center, zoom) {\n        var viewHalf = this.getSize()._divideBy(2);\n        if (!this._rotate) {\n            mapProto._getNewPixelOrigin.call(this, center, zoom);\n        }\n        return this.project(center, zoom)\n            .rotate(this._bearing)\n            ._subtract(viewHalf)\n            ._add(this._getMapPanePos())\n            ._add(this._getRotatePanePos())\n            .rotate(-this._bearing)\n            ._round();\n    },\n\n    _handleGeolocationResponse: function(pos) {\n        var lat = pos.coords.latitude,\n            lng = pos.coords.longitude,\n            // TODO: use mapProto._handleGeolocationResponse\n            hdg = pos.coords.heading,\n            latlng = new L.LatLng(lat, lng),\n            bounds = latlng.toBounds(pos.coords.accuracy),\n            options = this._locateOptions;\n\n        if (options.setView) {\n            var zoom = this.getBoundsZoom(bounds);\n            this.setView(latlng, options.maxZoom ? Math.min(zoom, options.maxZoom) : zoom);\n        }\n\n        var data = {\n            latlng: latlng,\n            bounds: bounds,\n            timestamp: pos.timestamp,\n            // TODO: use mapProto._handleGeolocationResponse\n            heading: hdg\n        };\n\n        for (var i in pos.coords) {\n            if (typeof pos.coords[i] === 'number') {\n                data[i] = pos.coords[i];\n            }\n        }\n\n        // @event locationfound: LocationEvent\n        // Fired when geolocation (using the [`locate`](#map-locate) method)\n        // went successfully.\n        this.fire('locationfound', data);\n    },\n\n});\r\n","/*\n * L.Map.CompassBearing will rotate the map according to a smartphone's compass.\n */\n\nL.Map.CompassBearing = L.Handler.extend({\n\n    initialize: function(map) {\n        if (!window.DeviceOrientationEvent) {\n            this._capable = false;\n            return;\n        }\n        this._capable = true;\n        this._map = map;\n\n        this._throttled = L.Util.throttle(this._onDeviceOrientation, 1000, this);\n    },\n\n    addHooks: function() {\n        if (this._capable && this._map._rotate) {\n            L.DomEvent.on(window, 'deviceorientation', this._throttled, this);\n        }\n    },\n\n    removeHooks: function() {\n        if (this._capable && this._map._rotate) {\n            L.DomEvent.off(window, 'deviceorientation', this._throttled, this);\n        }\n    },\n\n    _onDeviceOrientation: function(event) {\n        if (event.alpha !== null) {\n            this._map.setBearing(event.alpha - window.orientation);\n        }\n    },\n\n});\n\n// @section Handlers\n// @property compassBearing: Handler\n// Compass bearing handler.\nL.Map.addInitHook('addHandler', 'compassBearing', L.Map.CompassBearing);\r\n","/*\n * L.Handler.ContainerMutation triggers `invalidateResize` when the map's DOM container mutates.\n */\n\n// @namespace Map\n// @section Interaction Options\nL.Map.mergeOptions({\n\n    // @option trackContainerMutation: Boolean = false\n    // Whether the map uses [mutation observers](https://developer.mozilla.org/docs/Web/API/MutationObserver)\n    // to detect changes in its container and trigger `invalidateSize`. Disabled\n    // by default due to support not being available in all web browsers.\n    trackContainerMutation: false\n\n});\n\nL.Map.ContainerMutation = L.Handler.extend({\n\n    addHooks: function() {\n        if (!L.Browser.mutation) {\n            return;\n        }\n\n        if (!this._observer) {\n            this._observer = new MutationObserver(L.Util.bind(this._onMutation, this));\n        }\n\n        this._observer.observe(this._map.getContainer(), {\n            childList: false,\n            attributes: true,\n            characterData: false,\n            subtree: false,\n            attributeFilter: ['style']\n        });\n    },\n\n    removeHooks: function() {\n        if (!L.Browser.mutation) {\n            return;\n        }\n        this._observer.disconnect();\n    },\n\n    _onMutation: function() {\n        this._map.invalidateSize();\n    },\n\n});\n\n// @section Handlers\n// @property containerMutation: Handler\n// Container mutation handler (disabled unless [`trackContainerMutation`](#map-trackcontainermutation) is set).\nL.Map.addInitHook('addHandler', 'trackContainerMutation', L.Map.ContainerMutation);\r\n","/*\n * L.Handler.TouchGestures is both TouchZoom plus TouchRotate.\n */\n\n// @namespace Map\n// @section Interaction Options\nL.Map.mergeOptions({\n\n    // @option bounceAtZoomLimits: Boolean = true\n    // Set it to false if you don't want the map to zoom beyond min/max zoom\n    // and then bounce back when pinch-zooming.\n    bounceAtZoomLimits: true,\n\n});\n\nL.Map.TouchGestures = L.Handler.extend({\n\n    initialize: function(map) {\n        this._map = map;\n        this.rotate = !!this._map.options.touchRotate;\n        this.zoom = !!this._map.options.touchZoom;\n    },\n\n    addHooks: function() {\n        L.DomEvent.on(this._map._container, 'touchstart', this._onTouchStart, this);\n    },\n\n    removeHooks: function() {\n        L.DomEvent.off(this._map._container, 'touchstart', this._onTouchStart, this);\n    },\n\n    _onTouchStart: function(e) {\n        var map = this._map;\n\n        if (!e.touches || e.touches.length !== 2 || map._animatingZoom || this._zooming || this._rotating) { return; }\n\n        var p1 = map.mouseEventToContainerPoint(e.touches[0]),\n            p2 = map.mouseEventToContainerPoint(e.touches[1]),\n            vector = p1.subtract(p2);\n\n        this._centerPoint = map.getSize()._divideBy(2);\n        this._startLatLng = map.containerPointToLatLng(this._centerPoint);\n\n        if (this.zoom) {\n            if (map.options.touchZoom !== 'center') {\n                this._pinchStartLatLng = map.containerPointToLatLng(p1.add(p2)._divideBy(2));\n            }\n            this._startDist = p1.distanceTo(p2);\n            this._startZoom = map.getZoom();\n            this._zooming = true;\n        } else {\n            this._zooming = false;\n        }\n\n        if (this.rotate) {\n            this._startTheta = Math.atan(vector.x / vector.y);\n            this._startBearing = map.getBearing();\n            if (vector.y < 0) { this._startBearing += 180; }\n            this._rotating = true;\n        } else {\n            this._rotating = false;\n        }\n\n        this._moved = false;\n\n        map.stop();\n\n        L.DomEvent\n            .on(document, 'touchmove', this._onTouchMove, this)\n            .on(document, 'touchend', this._onTouchEnd, this);\n\n        L.DomEvent.preventDefault(e);\n    },\n\n    _onTouchMove: function(e) {\n        if (!e.touches || e.touches.length !== 2 || !(this._zooming || this._rotating)) { return; }\n\n        var map = this._map,\n            p1 = map.mouseEventToContainerPoint(e.touches[0]),\n            p2 = map.mouseEventToContainerPoint(e.touches[1]),\n            vector = p1.subtract(p2),\n            scale = p1.distanceTo(p2) / this._startDist,\n            delta;\n\n        if (this._rotating) {\n            var theta = Math.atan(vector.x / vector.y);\n            var bearingDelta = (theta - this._startTheta) * L.DomUtil.RAD_TO_DEG;\n            if (vector.y < 0) { bearingDelta += 180; }\n            if (bearingDelta) {\n                /// TODO: The pivot should be the last touch point, but zoomAnimation manages to\n                ///   overwrite the rotate pane position. Maybe related to #3529.\n                map.setBearing(this._startBearing - bearingDelta);\n            }\n        }\n\n        if (this._zooming) {\n            this._zoom = map.getScaleZoom(scale, this._startZoom);\n\n            if (!map.options.bounceAtZoomLimits && (\n                    (this._zoom < map.getMinZoom() && scale < 1) ||\n                    (this._zoom > map.getMaxZoom() && scale > 1))) {\n                this._zoom = map._limitZoom(this._zoom);\n            }\n\n            if (map.options.touchZoom === 'center') {\n                this._center = this._startLatLng;\n                if (scale === 1) { return; }\n            } else {\n                // Get delta from pinch to center, so centerLatLng is delta applied to initial pinchLatLng\n                delta = p1._add(p2)._divideBy(2)._subtract(this._centerPoint);\n                if (scale === 1 && delta.x === 0 && delta.y === 0) { return; }\n\n                var alpha = -map.getBearing() * L.DomUtil.DEG_TO_RAD;\n\n                this._center = map.unproject(map.project(this._pinchStartLatLng).subtract(delta.rotate(alpha)));\n            }\n\n        }\n\n        if (!this._moved) {\n            map._moveStart(true);\n            this._moved = true;\n        }\n\n        L.Util.cancelAnimFrame(this._animRequest);\n\n        var moveFn = L.bind(map._move, map, this._center, this._zoom, { pinch: true, round: false });\n        this._animRequest = L.Util.requestAnimFrame(moveFn, this, true);\n\n        L.DomEvent.preventDefault(e);\n    },\n\n    _onTouchEnd: function() {\n        if (!this._moved || !this._zooming) {\n            this._zooming = false;\n            return;\n        }\n\n        this._zooming = false;\n        this._rotating = false;\n        L.Util.cancelAnimFrame(this._animRequest);\n\n        L.DomEvent\n            .off(document, 'touchmove', this._onTouchMove)\n            .off(document, 'touchend', this._onTouchEnd);\n\n        if (this.zoom) {\n            // Pinch updates GridLayers' levels only when snapZoom is off, so snapZoom becomes noUpdate.\n            if (this._map.options.zoomAnimation) {\n                this._map._animateZoom(this._center, this._map._limitZoom(this._zoom), true, this._map.options.snapZoom);\n            } else {\n                this._map._resetView(this._center, this._map._limitZoom(this._zoom));\n            }\n        }\n    },\n\n});\n\n// @section Handlers\n// @property touchGestures: Handler\n// Touch gestures handler.\nL.Map.addInitHook('addHandler', 'touchGestures', L.Map.TouchGestures);\r\n","/*\n * L.Handler.TouchRotate is used by L.Map to add two-finger rotation gestures.\n */\n\n// @namespace Map\n// @section Interaction Options\nL.Map.mergeOptions({\n\n    // @section Touch interaction options\n    // @option touchRotate: Boolean|String = *\n    // Whether the map can be rotated with a two-finger rotation gesture\n    touchRotate: false,\n\n});\n\nL.Map.TouchRotate = L.Handler.extend({\n\n    addHooks: function() {\n        this._map.touchGestures.enable();\n        this._map.touchGestures.rotate = true;\n    },\n\n    removeHooks: function() {\n        this._map.touchGestures.rotate = false;\n    },\n\n});\n\n// @section Handlers\n// @property touchZoom: Handler\n// Touch rotate handler.\nL.Map.addInitHook('addHandler', 'touchRotate', L.Map.TouchRotate);\r\n","/*\n * L.Handler.ShiftKeyRotate is used by L.Map to add shift-wheel rotation.\n */\n\n// @namespace Map\n// @section Interaction Options\nL.Map.mergeOptions({\n\n    // @section Touch interaction options\n    // @option touchRotate: Boolean|String = *\n    // Whether the map can be rotated with a two-finger rotation gesture\n    shiftKeyRotate: true,\n\n});\n\nL.Map.ShiftKeyRotate = L.Handler.extend({\n\n    addHooks: function() {\n        L.DomEvent.on(this._map._container, \"wheel\", this._handleShiftScroll, this);\n        // this._map.shiftKeyRotate.enable();\n        this._map.shiftKeyRotate.rotate = true;\n    },\n\n    removeHooks: function() {\n        L.DomEvent.off(this._map._container, \"wheel\", this._handleShiftScroll, this);\n        this._map.shiftKeyRotate.rotate = false;\n    },\n\n    _handleShiftScroll: function(e) {\n        if (e.shiftKey) {\n            e.preventDefault();\n            this._map.scrollWheelZoom.disable();\n            this._map.setBearing((this._map._bearing * L.DomUtil.RAD_TO_DEG) + e.deltaY);\n        } else {\n            this._map.scrollWheelZoom.enable();\n        }\n    },\n\n});\n\n// @section Handlers\n// @property touchZoom: Handler\n// Touch rotate handler.\nL.Map.addInitHook('addHandler', 'shiftKeyRotate', L.Map.ShiftKeyRotate);\r\n","/*\n * L.Handler.TouchZoom is used by L.Map to add pinch zoom on supported mobile browsers.\n */\n\n// @namespace Map\n// @section Interaction Options\nL.Map.mergeOptions({\n\n    // @section Touch interaction options\n    // @option touchZoom: Boolean|String = *\n    // Whether the map can be zoomed by touch-dragging with two fingers. If\n    // passed `'center'`, it will zoom to the center of the view regardless of\n    // where the touch events (fingers) were. Enabled for touch-capable web\n    // browsers except for old Androids.\n    touchZoom: L.Browser.touch && !L.Browser.android23,\n\n    bounceAtZoomLimits: false,\n});\n\nL.Map.TouchZoom = L.Handler.extend({\n\n    addHooks: function() {\n        L.DomUtil.addClass(this._map._container, 'leaflet-touch-zoom');\n        this._map.touchGestures.enable();\n        this._map.touchGestures.zoom = true;\n    },\n\n    removeHooks: function() {\n        L.DomUtil.removeClass(this._map._container, 'leaflet-touch-zoom');\n        this._map.touchGestures.zoom = false;\n    },\n\n});\n\n// @section Handlers\n// @property touchZoom: Handler\n// Touch zoom handler.\nL.Map.addInitHook('addHandler', 'touchZoom', L.Map.TouchZoom);\r\n","/**\n * L.Control.Rotate\n */\n\n// A tri-state control for map rotation. States are:\n// Locked (default)\n// Unlocked (user can pinch-rotate)\n// Follow (rotation follows device orientation, if available)\nL.Control.Rotate = L.Control.extend({\n\n    options: {\n        position: 'topleft',\n        closeOnZeroBearing: true\n    },\n\n    onAdd: function(map) {\n        this._onDeviceOrientation = L.Util.throttle(this._unthrottledOnDeviceOrientation, 100, this);\n\n        var container = this._container = L.DomUtil.create('div', 'leaflet-control-rotate leaflet-bar');\n\n        // this.button = L.Control.Zoom.prototype._createButton.call(this, 'R', 'leaflet-control-rotate', 'leaflet-control-rotate', container, this._toggleLock);\n\n        var arrow = this._arrow = L.DomUtil.create('span', 'leaflet-control-rotate-arrow');\n\n        arrow.style.backgroundImage = `url(\"data:image/svg+xml;charset=utf-8,%3Csvg width='29' height='29' viewBox='0 0 29 29' xmlns='http://www.w3.org/2000/svg' fill='%23333'%3E%3Cpath d='M10.5 14l4-8 4 8h-8z'/%3E%3Cpath d='M10.5 16l4 8 4-8h-8z' fill='%23ccc'/%3E%3C/svg%3E\")`;\n        arrow.style.cursor = 'grab';\n        arrow.style.display = 'block';\n        arrow.style.width = '100%';\n        arrow.style.height = '100%';\n        arrow.style.backgroundRepeat = 'no-repeat';\n        arrow.style.backgroundPosition = '50%';\n\n        // Copy-pasted from L.Control.Zoom\n        var link = this._link = L.DomUtil.create('a', 'leaflet-control-rotate-toggle', container);\n        link.appendChild(arrow);\n        link.href = '#';\n        link.title = 'leaflet-control-rotate-toggle';\n\n        L.DomEvent\n            .on(link, 'dblclick', L.DomEvent.stopPropagation)\n            .on(link, 'mousedown', this._handleMouseDown, this)\n            .on(link, 'click', L.DomEvent.stop)\n            .on(link, 'click', this._cycleState, this)\n            .on(link, 'click', this._refocusOnMap, this);\n\n        if (!L.Browser.any3d) {\n            L.DomUtil.addClass(link, 'leaflet-disabled');\n        }\n\n        this._restyle();\n\n        map.on('rotate', this._restyle.bind(this));\n\n        // State flag\n        this._follow = false;\n        this._canFollow = false;\n\n        if (this.options.closeOnZeroBearing && map.getBearing() === 0) {\n            container.style.display = 'none';\n        }\n\n        return container;\n    },\n\n    _handleMouseDown: function(e) {\n        L.DomEvent.stopPropagation(e);\n        this.dragging = true;\n        this.dragstartX = e.pageX;\n        this.dragstartY = e.pageY;\n        L.DomEvent\n            .on(document, 'mousemove', this._handleMouseDrag, this)\n            .on(document, 'mouseup', this._handleMouseUp, this);\n    },\n\n    _handleMouseUp: function(e) {\n        L.DomEvent.stopPropagation(e);\n        this.dragging = false;\n\n        L.DomEvent\n            .off(document, 'mousemove', this._handleMouseDrag, this)\n            .off(document, 'mouseup', this._handleMouseUp, this);\n    },\n\n    _handleMouseDrag: function(e) {\n        if (!this.dragging) { return; }\n        var deltaX = e.clientX - this.dragstartX;\n        this._map.setBearing(deltaX);\n    },\n\n    _cycleState: function(ev) {\n        var map = this._map;\n\n        if (!map) { return; }\n\n        if (!map.touchRotate.enabled() && !map.compassBearing.enabled()) {\n            // Go from disabled to touch\n            map.touchRotate.enable();\n\n            // console.log('state is now: touch rotate');\n        } else {\n\n            if (!map.compassBearing.enabled()) {\n                // Go from touch to compass\n                map.touchRotate.disable();\n                map.compassBearing.enable();\n\n                // console.log('state is now: compass');\n\n                // It is possible that compass is not supported. If so,\n                // the hangler will automatically go from compass to disabled.\n            } else {\n                // Go from compass to disabled\n                map.compassBearing.disable();\n\n                // console.log('state is now: locked');\n\n                map.setBearing(0);\n                if (this.options.closeOnZeroBearing) {\n                    map.touchRotate.enable();\n                }\n            }\n        }\n        this._restyle();\n    },\n\n    _restyle: function() {\n        if (this._map.options.rotate) {\n            var map = this._map;\n            var bearing = map.getBearing();\n            if (this.options.closeOnZeroBearing && bearing) {\n                this._container.style.display = 'block';\n            }\n\n            var cssTransform = 'rotate(' + bearing + 'deg)';\n            this._arrow.style.transform = cssTransform;\n\n            if (map.compassBearing.enabled()) {\n                this._link.style.backgroundColor = 'orange';\n            } else if (map.touchRotate.enabled()) {\n                this._link.style.backgroundColor = null;\n            } else {\n                this._link.style.backgroundColor = 'grey';\n                if (this.options.closeOnZeroBearing && map.getBearing() === 0) {\n                    this._container.style.display = 'none';\n                }\n            }\n        } else {\n            L.DomUtil.addClass(link, 'leaflet-disabled');\n        }\n    },\n\n});\n\nL.control.rotate = function(options) {\n    return new L.Control.Rotate(options);\n};\n\nL.Map.mergeOptions({\n    rotateControl: true,\n});\n\nL.Map.addInitHook(function() {\n    if (this.options.rotateControl) {\n        var options = typeof this.options.rotateControl === 'object' ? this.options.rotateControl : {};\n        this.rotateControl = L.control.rotate(options);\n        this.addControl(this.rotateControl);\n    }\n});\r\n"],"names":["domUtilProto","setTransform","L","DomUtil","setPosition","extend","el","offset","scale","bearing","pivot","pos","Point","_round","call","this","rotateFrom","style","TRANSFORM","x","y","point","_leaflet_pos","Browser","any3d","undefined","left","top","DEG_TO_RAD","Math","PI","RAD_TO_DEG","Draggable","include","updateMapBearing","mapBearing","_mapBearing","prototype","rotate","theta","sinTheta","sin","cosTheta","cos","cx","cy","divOverlayProto","getEvents","DivOverlay","_updatePosition","_map","latLngToLayerPoint","_latlng","options","anchor","_getAnchor","_zoomAnimated","_rotate","rotatedPointToMapPanePoint","_container","add","bottom","_containerBottom","_containerLeft","round","_containerWidth","popupProto","_animateZoom","Popup","_adjustPan","e","_latLngToNewLayerPoint","zoom","center","autoPan","_panAnim","_inProgress","map","marginBottom","parseInt","getStyle","containerHeight","offsetHeight","containerWidth","layerPos","_add","getPosition","containerPos","_getMapPanePos","padding","autoPanPadding","paddingTL","autoPanPaddingTopLeft","paddingBR","autoPanPaddingBottomRight","size","getSize","dx","dy","fire","panBy","tooltipProto","Tooltip","_setPosition","Icon","_setIconStyles","img","name","sizeOption","shadowAnchor","iconAnchor","divideBy","className","marginLeft","marginTop","width","height","markerDragProto","_onDragStart","_onDrag","_onDragEnd","MarkerDrag","_marker","_draggable","_bearing","marker","rotated_marker","rotation","rotateWithView","shadow","_shadow","iconPos","_icon","mapPanePointToRotatedPoint","latlng","layerPointToLatLng","oldLatLng","_oldLatLng","setLatLng","update","markerProto","Marker","onAdd","_initInteraction","_setPos","_updateZIndex","mergeOptions","on","ret","dragging","bind","_zIndex","zIndexOffset","_resetZIndex","zIndex","setRotation","gridLayerProto","GridLayer","_getTiledPixelBounds","events","updateWhenIdle","_onRotate","Util","throttle","_onMoveEnd","updateInterval","mapZoom","_animatingZoom","max","_animateToZoom","getZoom","getZoomScale","_tileZoom","pixelCenter","project","floor","halfSize","Bounds","containerPointToLayerPoint","subtract","canvasProto","Canvas","onRemove","_update","_redraw","off","rendererProto","Renderer","_updateTransform","_zoom","_topLeft","p","padMin","multiplyBy","padMax","clip","_bounds","min","_center","getCenter","svgProto","SVG","mapProto","initialize","Map","createPane","getBounds","layerPointToContainerPoint","_initPanes","_getCenterOffset","_getNewPixelOrigin","_handleGeolocationResponse","id","container","_rotatePane","_mapPane","_pivot","_getRotatePanePos","topleft","topright","bottomright","bottomleft","LatLngBounds","setBearing","rotatePanePos","clone","_rotatePanePos","getBearing","panes","_panes","_paneRenderers","_norotatePane","markerZoomAnimation","addClass","markerPane","shadowPane","_subtract","centerOffset","viewHalf","_divideBy","lat","coords","latitude","lng","longitude","hdg","heading","LatLng","bounds","toBounds","accuracy","_locateOptions","setView","getBoundsZoom","maxZoom","data","timestamp","i","CompassBearing","Handler","window","DeviceOrientationEvent","_capable","_throttled","_onDeviceOrientation","addHooks","DomEvent","removeHooks","event","alpha","orientation","addInitHook","trackContainerMutation","ContainerMutation","mutation","_observer","MutationObserver","_onMutation","observe","getContainer","childList","attributes","characterData","subtree","attributeFilter","disconnect","invalidateSize","bounceAtZoomLimits","TouchGestures","touchRotate","touchZoom","_onTouchStart","touches","length","_zooming","_rotating","p1","mouseEventToContainerPoint","p2","vector","_centerPoint","_startLatLng","containerPointToLatLng","_pinchStartLatLng","_startDist","distanceTo","_startZoom","_startTheta","atan","_startBearing","_moved","stop","document","_onTouchMove","_onTouchEnd","preventDefault","delta","bearingDelta","getScaleZoom","getMinZoom","getMaxZoom","_limitZoom","unproject","_moveStart","cancelAnimFrame","_animRequest","moveFn","_move","pinch","requestAnimFrame","zoomAnimation","snapZoom","_resetView","TouchRotate","touchGestures","enable","shiftKeyRotate","ShiftKeyRotate","_handleShiftScroll","shiftKey","scrollWheelZoom","disable","deltaY","touch","android23","TouchZoom","removeClass","Control","Rotate","position","closeOnZeroBearing","_unthrottledOnDeviceOrientation","create","arrow","_arrow","backgroundImage","cursor","display","backgroundRepeat","backgroundPosition","link","_link","appendChild","href","title","stopPropagation","_handleMouseDown","_cycleState","_refocusOnMap","_restyle","_follow","_canFollow","dragstartX","pageX","dragstartY","pageY","_handleMouseDrag","_handleMouseUp","deltaX","clientX","ev","enabled","compassBearing","cssTransform","transform","backgroundColor","control","rotateControl","addControl"],"mappings":"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"}