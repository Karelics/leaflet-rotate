'use strict';L.Rotate={debug:function(map,options={}){this._map=map;document.head.insertAdjacentHTML("beforeend",`<style>\n            .leaflet-rotate-info {\n              width: 100%;\n            }\n            .leaflet-rotate-info td {\n              width: 7em;\n              overflow: hidden;\n              max-width: 7em;\n              text-overflow: ellipsis;\n            }\n            .leaflet-rotate-info th {\n              text-align: left;\n            }\n            div.crosshair {\n              position:absolute;\n              width:1px;\n              height:1px;\n              border: 1px solid green;\n              z-index: 100;\n              left: 50%;\n              right: 50%;\n            }\n            div.pivot {\n              position:absolute;\n              width:1px;\n              height:1px;\n              border: 1px solid purple;\n              z-index: 100;\n            }\n            div.pixelorigin {\n              position:absolute;\n              width:1px;\n              height:1px;\n              border: 1px solid cyan;\n              z-index: 100;\n            }\n            div.panebounds.main {\n              position:absolute;\n              width:800px;\n              height:600px;\n              border: 1px solid red;\n              border-bottom: 1px red dashed;\n              border-right: 1px red dashed;\n              z-index: 100;\n            }\n            div.panebounds.rotate {\n              position:absolute;\n              width:800px;\n              height:600px;\n              border: 1px solid purple;\n              border-bottom: 1px purple dashed;\n              border-right: 1px purple dashed;\n              z-index: 100;\n            }\n            div.crosshair.c1 {\n              left:calc(50% - 5px);\n              top:50%;\n              height: 0;\n              width: 10px;\n            }\n            div.crosshair.c2 {\n              left:50%;\n              top:calc(50% - 5px);\n              width: 0;\n              height: 10px;\n            }\n            #rho_input {\n              vertical-align: middle;\n            }\n            .panebounds:before {\n              padding: 1ch;\n            }\n            .panebounds.rotate:before {\n              float: right;\n              content: 'ROTATED';\n            }\n            .panebounds.main:before {\n              float: left;\n              content: 'MAIN';\n            }\n          </style>`);
map._container.insertAdjacentHTML("afterbegin",`<div class="crosshair c1"></div><div class="crosshair c2"></div>`);map._container.insertAdjacentHTML("afterend",`<hr>\n        <table class="leaflet-rotate-info">\n          <tr>\n            <td>\n              <button onclick="map.setBearing(0);"> 0</button>\n              <button onclick="map.setBearing(15);">15</button>\n              <button onclick="map.setBearing(30);">30</button>\n              <button onclick="map.setBearing(45);">45</button>\n              <button onclick="map.setBearing(60);">60</button>\n              <button onclick="map.setBearing(75);">75</button>\n              <button onclick="map.setBearing(90);">90</button>\n              <button onclick="map.setBearing(180);">180</button>\n            </td>\n            <td>\n              <button onclick="L.Rotate.randomRotateMarkers(map);">Rotate Markers</button>\n              <input type="range" min="0" max="360" step="1" name="rho" id='rho_input' /><span id='rho'></span>\n            </td>\n            <td></td>\n            <td></td>\n          </tr>\n          <tr>\n            <th>LatLng </th>\n            <td id='llx'></td>\n            <td id='lly'></td>\n            <td class='long'>LatLng of mouse pointer</td>\n          </tr>\n          <tr>\n            <th>Rel to pane </th>\n            <td id='lyx'></td>\n            <td id='lyy'></td>\n            <td class='long'>Mouse pointer pixel coords relative to _rotatePane</td>\n          </tr>\n          <tr>\n            <th>Rel to container</th>\n            <td id='cnx'></td>\n            <td id='cny'></td>\n            <td class='long'>Mouse pointer coords relative to map &lt;div&gt;</td>\n          </tr>\n          <tr>\n            <th>Pivot </th>\n            <td id='pvx'></td>\n            <td id='pvy'></td>\n            <td class='long'>Last _rotationPane pivot pixel coords relative to _rotationPane</td>\n          </tr>\n          <tr>\n            <th>Pane offset </th>\n            <td id='pox'></td>\n            <td id='poy'></td>\n            <td class='long'>Pixel offset of _mapPane</td>\n          </tr>\n          <tr>\n            <th>Pixel origin </th>\n            <td id='ogx'></td>\n            <td id='ogy'></td>\n            <td class='long'>Negative pixel coords of the (0,0) CRS point relative to _rotatePane</td>\n          </tr>\n        </table>`);
map.___rotatePixelOrigin=L.DomUtil.create("div","pixelorigin",map._rotatePane);map.___rotatePivotDot=L.DomUtil.create("div","pivot",map._mapPane);L.DomUtil.create("div","panebounds rotate",map._rotatePane);L.DomUtil.create("div","panebounds main",map._mapPane);var rhoInput=document.getElementById("rho_input");rhoInput.addEventListener("change",L.Rotate.rotate);rhoInput.addEventListener("mousemove",L.Rotate.rotate);map.on("move rotate zoomend",this.updatePanePos);map.on("rotate zoomend load",this.updatePixelOrigin);
this.updatePixelOrigin.call(map);map.on("rotate",this.updatePivotDot);if(options.log){map.on("mousemove",this.logMouse);map.on("click",this.logEvent);map.on("movestart",this.logEvent);map.on("move",this.logEvent);map.on("moveend",this.logEvent);map.on("zoomstart",this.logEvent);map.on("zoomend",this.logEvent)}},logEvent:function(e){console.log(e,e.type)},logMouse:function(e){document.getElementById("llx").innerHTML=e.latlng.lng;document.getElementById("lly").innerHTML=e.latlng.lat;document.getElementById("lyx").innerHTML=
e.layerPoint.x;document.getElementById("lyy").innerHTML=e.layerPoint.y;document.getElementById("cnx").innerHTML=e.containerPoint.x;document.getElementById("cny").innerHTML=e.containerPoint.y},rotate:function(e){return e.buttons!==0&&map.setBearing(e.target.valueAsNumber)},updatePixelOrigin:function(){document.getElementById("ogx").innerHTML=this._pixelOrigin.x;document.getElementById("ogy").innerHTML=this._pixelOrigin.y;this.___rotatePixelOrigin.style.left=-this._pixelOrigin.x-1+"px";this.___rotatePixelOrigin.style.top=
-this._pixelOrigin.y-1+"px"},updatePivotDot:function(){document.getElementById("pvx").innerHTML=this._pivot.x;document.getElementById("pvy").innerHTML=this._pivot.y;this.___rotatePivotDot.style.left=this._pivot.x-1+"px";this.___rotatePivotDot.style.top=this._pivot.y-1+"px"},updatePanePos:function(){var panePos=this._getMapPanePos();document.getElementById("pox").innerHTML=panePos.x;document.getElementById("poy").innerHTML=panePos.y},rotateOneDegree:function(){var angle=document.getElementById("rho_input").valueAsNumber++;
this.setBearing(angle<360?angle:0)},randomRotateMarkers:function(map){var markers=[],steps=[];for(var i in map._layers)if(map._layers[i]instanceof L.Marker){markers.push(map._layers[i]);steps.push(Math.random()*Math.PI/30+.1)}function stepOn(steps_left){for(var i=0;i<markers.length;i++)markers[i].setRotation(markers[i].options.rotation+steps[i]);if(--steps_left)setTimeout(stepOn.bind(null,steps_left),20)}stepOn(25)}};
